# Codex Progress Log

## 2026-02-18

- Established Codex long-running harness baseline.
- Added required workflow assets:
  - `AGENTS.md`
  - `feature_list.json`
  - `init.sh`
  - `scripts/codex-session-start.sh`
  - `scripts/codex-verify.sh`
  - `verification/.gitkeep`
- Added project-level Codex configuration:
  - `.codex/config.toml`
  - `.codex/instructions/coding_agent.md`
  - `.codex/instructions/initializer_agent.md`
- Next: implement and verify highest-priority tracking items from `feature_list.json`.

## 2026-02-18 (harness hardening pass)

- Completed:
  - Added non-interactive ESLint setup (`.eslintrc.json`, `eslint`, `eslint-config-next`) so `pnpm lint` can run in CI/agent loops.
  - Updated `scripts/codex-session-start.sh` with guardrails:
    - `docs/tracking.md` presence check
    - warning when `feature_list.json` has no passing baseline
    - branch + working-tree status
    - `NEXT_PUBLIC_GTM_ID` environment warning
  - Added `docs/tracking.md` contract scaffold from `prompts/tracking-improvement-spec.xml`.
  - Stabilized build verification path:
    - Updated `scripts/codex-verify.sh` to use `next build --experimental-build-mode=compile` (avoids sandbox EXDEV rename failure).
    - Removed `next/font/google` build-time fetch dependency from `app/layout.tsx` and added CSS font variable fallbacks in `app/globals.css`.
    - Deferred env-dependent service initialization to request/runtime in:
      - `app/api/contact/route.ts`
      - `app/api/notify-lead/route.ts`
      - `app/api/booking/create/route.ts`
      - `app/actions/payment.ts`
- Verified:
  - `bash scripts/codex-session-start.sh` executes and reports new guardrails.
  - `pnpm lint` exits `0` (warnings only).
  - `pnpm next build --experimental-build-mode=compile` exits `0`.
  - `bash scripts/codex-verify.sh` exits `0`.
- Regressions/blockers:
  - Blocker: no `passes: true` items in `feature_list.json`, so “re-verify previously passing flow” rule is currently blocked.
- Evidence:
  - `verification/2026-02-18-harness-fixes/session-start.log`
  - `verification/2026-02-18-harness-fixes/codex-verify.log`
  - `verification/2026-02-18-harness-fixes/codex-verify.exit`
  - `verification/2026-02-18-harness-fixes/lint.log`
  - `verification/2026-02-18-harness-fixes/lint.exit`
  - `verification/2026-02-18-harness-fixes/build.log`
  - `verification/2026-02-18-harness-fixes/build.exit`
  - `verification/2026-02-18-harness-fixes/README.md`
- Next highest-priority action:
  - Implement and verify first P0 tracking item to establish baseline `passes: true`.
  - Start spec/backlog alignment notes inside `feature_list.json` entries to reduce event-contract drift.

## 2026-02-19 (real E2E wiring + first P0 baseline)

- Completed:
  - Wired true Playwright E2E execution into `test:e2e` via `harness/scripts/run-e2e.sh`.
    - Handles Playwright Chromium install.
    - Adds Linux NSS/NSPR shared-library bootstrap fallback for environments missing system libs.
  - Fixed Playwright web server startup command in `playwright.config.ts` (`pnpm dev --hostname 127.0.0.1 --port 3000`).
  - Implemented route-level `page_view` emission through `trackEvent(...)` in `TrackingBootstrap` with dedupe guard to prevent duplicate pushes on remount/hydration.
  - Replaced placeholder smoke check with a real P0 tracking E2E assertion:
    - verifies exactly one `page_view` on home load
    - verifies payload includes `page_path` (`/`) and non-empty `page_title`
    - writes JSON payload + screenshot into `harness/verification/`
- Feature status transition:
  - `TRK-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e` passes (Playwright Chromium).
  - `bash harness/scripts/codex-verify.sh` passes (lint + build).
  - `bash harness/scripts/codex-acceptance.sh` passes (all 3 gates).
- Evidence:
  - `harness/verification/2026-02-19-e2e-p0/trk-001-home.png`
  - `harness/verification/2026-02-19-e2e-p0/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-e2e-p0/test-e2e.log`
  - `harness/verification/2026-02-19-e2e-p0/test-e2e.exit`
  - `harness/verification/2026-02-19-e2e-p0/codex-verify.log`
  - `harness/verification/2026-02-19-e2e-p0/codex-verify.exit`
  - `harness/verification/2026-02-19-e2e-p0/codex-acceptance.log`
  - `harness/verification/2026-02-19-e2e-p0/codex-acceptance.exit`
  - `harness/verification/2026-02-19-e2e-p0/EVIDENCE-MANIFEST.md` (含 commit hash + sha256 清单)
- Next highest-priority action:
  - Re-verify `TRK-001` as the newly established regression baseline at session start, then implement the next failing P0 item (`TRK-002`).

## Template For Future Sessions

- Date:
- Completed items:
- Verified flows:
- Regressions found/fixed:
- Evidence files (screenshots/logs):
- Next highest-priority item:

## 2026-02-19 (TRK-002 canonical page path + baseline recheck)

- Completed:
  - Re-ran session bootstrap via `bash harness/scripts/codex-session-start.sh`.
  - Implemented `trackEvent(...)` page context normalization in `lib/tracking.ts`:
    - `page_path` now uses canonical `window.location.pathname` (query string removed).
    - `page_title` now trims whitespace and falls back to `"Real Hibachi"` when blank.
  - Added deterministic verification harness script:
    - `harness/scripts/verify-tracking-page-view.mjs`
    - transpiles `lib/tracking.ts` and validates payload behavior with mocked browser globals.
- Feature status transition:
  - `TRK-002` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - Baseline recheck (`TRK-001` intent-level contract) via tracking harness script.
  - New `TRK-002` canonical path/title assertions via tracking harness script.
  - `bash harness/scripts/codex-verify.sh` passes (lint + build).
- Regressions/blockers:
  - Blocker (environment): Playwright UI verification is currently blocked in this sandbox due local loopback/network restrictions (`connect EPERM 127.0.0.1:3000`) and missing browser shared-lib path integration for MCP Chromium.
  - Captured failed Playwright reverify attempt as evidence; used deterministic code-level harness verification for this session.
- Evidence:
  - `harness/verification/2026-02-19-trk-002/reverify-trk-001.log`
  - `harness/verification/2026-02-19-trk-002/reverify-trk-001.exit`
  - `harness/verification/2026-02-19-trk-002/verify-trk-001-trk-002.log`
  - `harness/verification/2026-02-19-trk-002/verify-trk-001-trk-002.exit`
  - `harness/verification/2026-02-19-trk-002/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-19-trk-002/codex-verify.log`
  - `harness/verification/2026-02-19-trk-002/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-003` (route navigation emits a new `page_view` for `/book`) once Playwright loopback restriction is resolved, or add a route-state harness test that can prove `TrackingBootstrap` navigation behavior without localhost networking.

## 2026-02-19 (TRK-003 home->book page_view + UI verification unblocked)

- Completed:
  - Re-verified previously passing baseline contracts (`TRK-001`, `TRK-002`) via `harness/scripts/verify-tracking-page-view.mjs`.
  - Added `TRK-003` Playwright coverage in `e2e/smoke.spec.ts`:
    - starts on `/`
    - clicks header **Book Now** CTA
    - waits for `/book`
    - asserts a new `page_view` exists with `page_path: "/book"`.
  - Improved `harness/scripts/run-e2e.sh` to reuse existing Playwright Chromium when present (skip redundant install step that stalled this environment).
- Feature status transition:
  - `TRK-003` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-003"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No functional regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-003/reverify-trk-001-trk-002.log`
  - `harness/verification/2026-02-19-trk-003/reverify-trk-001-trk-002.exit`
  - `harness/verification/2026-02-19-trk-003/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-19-trk-003/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-003/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-003/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-003/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-003/trk-003-e2e.log`
  - `harness/verification/2026-02-19-trk-003/trk-003-e2e.exit`
  - `harness/verification/2026-02-19-trk-003/trk-003-navigation-page-view-events.json`
  - `harness/verification/2026-02-19-trk-003/trk-003-book.png`
  - `harness/verification/2026-02-19-trk-003/codex-verify.log`
  - `harness/verification/2026-02-19-trk-003/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-004` (no duplicate `page_view` on single route load/hydration).

## 2026-02-19 (TRK-004 no duplicate page_view on hydration)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified a previously passing core flow (`TRK-001`) before new work.
  - Added dedicated Playwright assertion for `TRK-004` in `e2e/smoke.spec.ts`:
    - load `/`
    - wait for hydration settle window
    - assert `dataLayer` contains exactly one `page_view` before any user interaction.
- Feature status transition:
  - `TRK-004` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-004"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-004/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-004/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-004/trk-004-e2e.log`
  - `harness/verification/2026-02-19-trk-004/trk-004-e2e.exit`
  - `harness/verification/2026-02-19-trk-004/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-004/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-004/trk-004-hydration-page-view-events.json`
  - `harness/verification/2026-02-19-trk-004/trk-004-home.png`
  - `harness/verification/2026-02-19-trk-004/codex-verify.log`
  - `harness/verification/2026-02-19-trk-004/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-005` (booking funnel start event on first actionable booking interaction).

## 2026-02-19 (TRK-005 booking funnel start on /book first action)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added `booking_funnel_start` support in `lib/tracking.ts` event union.
  - Instrumented `/book` first-step CTA (`Get Estimate`) to emit `booking_funnel_start` before navigation.
  - Added Playwright coverage for TRK-005 in `e2e/smoke.spec.ts`.
- Feature status transition:
  - `TRK-005` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-005"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
  - Note: backlog currently uses `booking_funnel_start`, which extends beyond the XML spec's normalized event list; retain for backlog conformance and revisit harmonization in later cleanup/doc pass.
- Evidence:
  - `harness/verification/2026-02-19-trk-005/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-005/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-005/trk-005-e2e.log`
  - `harness/verification/2026-02-19-trk-005/trk-005-e2e.exit`
  - `harness/verification/2026-02-19-trk-005/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-005/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-005/trk-005-booking-funnel-start-events.json`
  - `harness/verification/2026-02-19-trk-005/trk-005-booking-start.png`
  - `harness/verification/2026-02-19-trk-005/codex-verify.log`
  - `harness/verification/2026-02-19-trk-005/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-006` (booking submit event payload completeness and no undefined values).

## 2026-02-19 (TRK-006 booking_submit payload completeness)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new work.
  - Added `booking_submit` event support in `lib/tracking.ts`.
  - Enhanced tracking payload normalization to remove undefined fields before `dataLayer.push(...)`.
  - Instrumented estimation submit flow (`app/estimation/page.tsx`) to emit `booking_submit` with booking/guest/date/time/value fields.
  - Added Playwright TRK-006 test covering full estimation -> booking submit path and asserting required payload keys have no undefined values.
- Feature status transition:
  - `TRK-006` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-006"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Initial TRK-006 automation failed due modal/step gating; fixed selectors and modal dismissal flow, then re-ran successfully.
  - `/api/notify-lead` returns expected error logs in test env when `RESEND_API_KEY` is absent; does not block tracking assertions.
- Evidence:
  - `harness/verification/2026-02-19-trk-006/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-006/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-006/trk-006-e2e.log`
  - `harness/verification/2026-02-19-trk-006/trk-006-e2e.exit`
  - `harness/verification/2026-02-19-trk-006/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-006/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-006/trk-006-booking-submit-events.json`
  - `harness/verification/2026-02-19-trk-006/trk-006-booking-submit.png`
  - `harness/verification/2026-02-19-trk-006/codex-verify.log`
  - `harness/verification/2026-02-19-trk-006/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-007` (deposit page primary CTA conversion-intent tracking event).

## 2026-02-19 (TRK-007 deposit CTA conversion intent)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Instrumented `/deposit` primary Stripe CTA to emit `deposit_started` with `booking_id`, `value`, and `currency`.
  - Added navigation guard flag for testability (`__REALHIBACHI_DISABLE_NAVIGATION__`) so tracking can be asserted without external redirect during E2E.
  - Added Playwright TRK-007 test to click primary deposit CTA and assert `deposit_started` payload in `dataLayer`.
- Feature status transition:
  - `TRK-007` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-007"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
  - `getBookingDetails` logs expected fallback errors in env without Supabase credentials; page fallback data remains functional for tracking validation.
- Evidence:
  - `harness/verification/2026-02-19-trk-007/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-007/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-007/trk-007-e2e.log`
  - `harness/verification/2026-02-19-trk-007/trk-007-e2e.exit`
  - `harness/verification/2026-02-19-trk-007/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-007/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-007/trk-007-deposit-started-events.json`
  - `harness/verification/2026-02-19-trk-007/trk-007-deposit.png`
  - `harness/verification/2026-02-19-trk-007/codex-verify.log`
  - `harness/verification/2026-02-19-trk-007/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-008` (contact form `lead_submit` with channel/source metadata).

## 2026-02-19 (TRK-008 contact lead_submit metadata)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Instrumented contact partner application form success path to emit `lead_submit`.
  - Added channel/source metadata on event payload:
    - `lead_channel: "contact_form"`
    - `lead_source: "contact_page"`
    - `lead_type: "partner_application"`
    - `service_type` (form-derived).
  - Added Playwright TRK-008 test with `/api/contact` stub to verify successful submit event payload deterministically.
- Feature status transition:
  - `TRK-008` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-008"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-008/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-008/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-008/trk-008-e2e.log`
  - `harness/verification/2026-02-19-trk-008/trk-008-e2e.exit`
  - `harness/verification/2026-02-19-trk-008/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-008/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-008/trk-008-lead-submit-events.json`
  - `harness/verification/2026-02-19-trk-008/trk-008-contact-submit.png`
  - `harness/verification/2026-02-19-trk-008/codex-verify.log`
  - `harness/verification/2026-02-19-trk-008/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-009` (Google Places selection `location_selected` with `place_id`).

## 2026-02-19 (TRK-009 location_selected with place_id)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Extended Google Places autocomplete tracking:
    - added `place_id` request field from Places API
    - emits `location_selected` on place selection with `place_id` + source metadata.
  - Added test hook event (`realhibachi:mock-place-select`) in `GooglePlacesAutocomplete` to enable deterministic E2E selection simulation without external Google UI dependency.
  - Added Playwright TRK-009 test through estimation flow step 6, dispatching mock place selection and asserting `location_selected` payload.
- Feature status transition:
  - `TRK-009` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-009"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
  - Known env log noise (`RESEND_API_KEY` missing) during estimation flow remains non-blocking for tracking checks.
- Evidence:
  - `harness/verification/2026-02-19-trk-009/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-009/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-009/trk-009-e2e.log`
  - `harness/verification/2026-02-19-trk-009/trk-009-e2e.exit`
  - `harness/verification/2026-02-19-trk-009/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-009/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-009/trk-009-location-selected-events.json`
  - `harness/verification/2026-02-19-trk-009/trk-009-location-selected.png`
  - `harness/verification/2026-02-19-trk-009/codex-verify.log`
  - `harness/verification/2026-02-19-trk-009/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-010` (menu package selection `package_selected` with package metadata).

## 2026-02-19 (TRK-010 package_selected package metadata)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added `package_selected` event support in tracking event union.
  - Instrumented package CTA flows on:
    - `app/hibachi-at-home/page.tsx`
    - `app/page.tsx`
    to emit `package_selected` with `package_name`, `price_tier`, `package_type` before navigation.
  - Added Playwright TRK-010 coverage clicking package CTA in “Our Popular Packages” and asserting payload metadata.
- Feature status transition:
  - `TRK-010` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-010"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-010/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-010/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-010/trk-010-e2e.log`
  - `harness/verification/2026-02-19-trk-010/trk-010-e2e.exit`
  - `harness/verification/2026-02-19-trk-010/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-010/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-010/trk-010-package-selected-events.json`
  - `harness/verification/2026-02-19-trk-010/trk-010-package-selected.png`
  - `harness/verification/2026-02-19-trk-010/codex-verify.log`
  - `harness/verification/2026-02-19-trk-010/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-011` (promo banner click `promotion_click` with campaign identifier).

## 2026-02-19 (TRK-011 promotion_click campaign identifier)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added `promotion_click` event support in tracking union.
  - Completed promo banner CTA wiring:
    - added CTA button rendering in `components/promotions/promotion-banner.tsx`
    - emits `promotion_click` with campaign metadata before route navigation
    - re-enabled banner on `/book` page (`app/book/page.tsx`).
  - Added Playwright TRK-011 test asserting `promotion_click` payload includes campaign identifier.
- Feature status transition:
  - `TRK-011` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-011"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Initial TRK-011 test failed due strict title assertion mismatch; updated assertion to site-level title pattern and re-ran to pass.
- Evidence:
  - `harness/verification/2026-02-19-trk-011/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-011/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-011/trk-011-e2e.log`
  - `harness/verification/2026-02-19-trk-011/trk-011-e2e.exit`
  - `harness/verification/2026-02-19-trk-011/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-011/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-011/trk-011-promotion-click-events.json`
  - `harness/verification/2026-02-19-trk-011/trk-011-promotion-click.png`
  - `harness/verification/2026-02-19-trk-011/codex-verify.log`
  - `harness/verification/2026-02-19-trk-011/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-012` (Instagram video interaction `social_video_engagement`).

## 2026-02-19 (TRK-012 social_video_engagement on Instagram interaction)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added `social_video_engagement` event support in tracking union.
  - Instrumented Instagram video interactions in `components/instagram-videos-section.tsx`:
    - play overlay clicks
    - Instagram external-open clicks
    with metadata (`video_id`, `interaction_type`, `video_source`, `is_embedded`).
  - Added accessibility labels for video interaction buttons to support deterministic UI automation.
  - Added Playwright TRK-012 test to trigger video interaction and assert event payload.
- Feature status transition:
  - `TRK-012` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `pnpm test:e2e --grep "TRK-001"` ✅
  - `pnpm test:e2e --grep "TRK-012"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Initial test assumption expected non-embedded play button; updated test to support both interaction paths (`play` or `open_instagram`) and re-ran to pass.
- Evidence:
  - `harness/verification/2026-02-19-trk-012/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-012/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-012/trk-012-e2e.log`
  - `harness/verification/2026-02-19-trk-012/trk-012-e2e.exit`
  - `harness/verification/2026-02-19-trk-012/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-012/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-012/trk-012-social-video-engagement-events.json`
  - `harness/verification/2026-02-19-trk-012/trk-012-social-video-engagement.png`
  - `harness/verification/2026-02-19-trk-012/codex-verify.log`
  - `harness/verification/2026-02-19-trk-012/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-013` (floating contact phone click `phone_click` event).

## 2026-02-19 (TRK-013 floating contact phone_click event)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on current branch.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added `phone_click` and `sms_click` to the shared tracking event union in `lib/tracking.ts`.
  - Instrumented floating contact call action in `components/floating-contact-buttons.tsx` to emit:
    - `phone_click`
    - metadata: `contact_surface: "floating_contact_buttons"`
  - Added a test-only navigation guard (`window.__REALHIBACHI_DISABLE_NAVIGATION__`) so Playwright can assert tracking without leaving the page via `tel:` navigation.
  - Added Playwright TRK-013 coverage in `e2e/smoke.spec.ts` to:
    - open mobile viewport
    - expand floating contact UI
    - click `Call Now`
    - assert `phone_click` payload appears in `dataLayer`.
- Feature status transition:
  - `TRK-013` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-013 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-013 pnpm test:e2e --grep "TRK-013"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-013/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-013/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-013/trk-013-e2e.log`
  - `harness/verification/2026-02-19-trk-013/trk-013-e2e.exit`
  - `harness/verification/2026-02-19-trk-013/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-013/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-013/trk-013-phone-click-events.json`
  - `harness/verification/2026-02-19-trk-013/trk-013-phone-click.png`
  - `harness/verification/2026-02-19-trk-013/codex-verify.log`
  - `harness/verification/2026-02-19-trk-013/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-014` (floating contact SMS click `sms_click` event).

## 2026-02-19 (TRK-014 floating contact sms_click event)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree after TRK-013 commit.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Instrumented floating contact SMS action in `components/floating-contact-buttons.tsx` to emit:
    - `sms_click`
    - metadata: `contact_surface: "floating_contact_buttons"`
  - Reused the existing test-only navigation guard (`window.__REALHIBACHI_DISABLE_NAVIGATION__`) to avoid real `sms:` navigation during automation.
  - Added Playwright TRK-014 coverage in `e2e/smoke.spec.ts` to:
    - open mobile viewport
    - expand floating contact UI
    - click `Send SMS`
    - assert `sms_click` payload appears in `dataLayer`.
- Feature status transition:
  - `TRK-014` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-014 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-014 pnpm test:e2e --grep "TRK-014"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-014/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-014/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-014/trk-014-e2e.log`
  - `harness/verification/2026-02-19-trk-014/trk-014-e2e.exit`
  - `harness/verification/2026-02-19-trk-014/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-014/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-014/trk-014-sms-click-events.json`
  - `harness/verification/2026-02-19-trk-014/trk-014-sms-click.png`
  - `harness/verification/2026-02-19-trk-014/codex-verify.log`
  - `harness/verification/2026-02-19-trk-014/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-015` (estimate completion `estimate_completed` event with total value).

## 2026-02-19 (TRK-015 estimate_completed with total estimate value)

- Completed:
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added `estimate_completed` to the tracking event union (`lib/tracking.ts`).
  - Instrumented estimation progression in `app/estimation/page.tsx`:
    - emits `estimate_completed` when advancing into Step 5 (estimate results screen)
    - includes numeric value fields:
      - `value` (for analytics currency handling)
      - `estimate_total`
      - `estimate_subtotal`
      - `travel_fee`
      - guest metadata (`guest_count`, `adults`, `kids`)
  - Added Playwright TRK-015 test in `e2e/smoke.spec.ts` to complete estimation steps through Step 5 and assert `estimate_completed` payload has numeric total.
  - Hardened TRK-015 e2e step-1 field filling to re-assert required fields before clicking `Next Step` to avoid flaky empty-field states.
- Feature status transition:
  - `TRK-015` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-015 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-015 pnpm test:e2e --grep "TRK-015"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Initial TRK-015 run timed out on disabled Step-1 `Next Step` button because some required fields were intermittently blank; updated test to re-fill all required fields immediately before continuing, then re-ran successfully.
  - Known non-blocking `RESEND_API_KEY` missing error is still emitted in dev logs from `/api/notify-lead`.
- Evidence:
  - `harness/verification/2026-02-19-trk-015/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-015/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-015/trk-015-e2e.log`
  - `harness/verification/2026-02-19-trk-015/trk-015-e2e.exit`
  - `harness/verification/2026-02-19-trk-015/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-015/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-015/trk-015-estimate-completed-events.json`
  - `harness/verification/2026-02-19-trk-015/trk-015-estimate-completed.png`
  - `harness/verification/2026-02-19-trk-015/codex-verify.log`
  - `harness/verification/2026-02-19-trk-015/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-016` (tracking resilience when GTM/dataLayer is unavailable).

## 2026-02-19 (TRK-016 tracking resilience without GTM)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Hardened tracking runtime in `lib/tracking.ts`:
    - if `window.dataLayer` is missing or not an array, normalize to `[]` before push.
  - Added Playwright TRK-016 test in `e2e/smoke.spec.ts` to verify resilience when GTM is unavailable:
    - block `googletagmanager.com` requests
    - explicitly unset `window.dataLayer`
    - interact with two tracked CTAs (`phone_click`, `sms_click`)
    - assert no `pageerror` runtime exceptions
    - assert tracking events are still recorded and UI remains usable.
- Feature status transition:
  - `TRK-016` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-016 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-016 pnpm test:e2e --grep "TRK-016"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Initial TRK-016 run timed out because the test attempted mobile-only floating CTA selectors on desktop viewport; fixed by setting mobile viewport and re-ran to pass.
- Evidence:
  - `harness/verification/2026-02-19-trk-016/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-016/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-016/trk-016-e2e.log`
  - `harness/verification/2026-02-19-trk-016/trk-016-e2e.exit`
  - `harness/verification/2026-02-19-trk-016/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-016/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-016/trk-016-runtime-errors.json`
  - `harness/verification/2026-02-19-trk-016/trk-016-event-summary.json`
  - `harness/verification/2026-02-19-trk-016/trk-016-tracking-resilience.png`
  - `harness/verification/2026-02-19-trk-016/codex-verify.log`
  - `harness/verification/2026-02-19-trk-016/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-017` (tracking bootstrap visual-regression check on home/book pages).

## 2026-02-19 (TRK-017 visual regression guard for tracking bootstrap)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added Playwright TRK-017 coverage in `e2e/smoke.spec.ts`:
    - loads `/` and `/book`
    - captures page screenshots for visual baselines
    - measures a stable layout anchor (`Home` nav link) before/after settle delay
    - asserts no meaningful Y-position or height shift (layout stability)
    - writes structured layout metrics JSON for audit.
- Feature status transition:
  - `TRK-017` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-017 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-017 pnpm test:e2e --grep "TRK-017"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Initial TRK-017 attempt used `h1` as anchor and failed on pages without a guaranteed `h1`; switched to persistent header nav anchor and re-ran successfully.
- Evidence:
  - `harness/verification/2026-02-19-trk-017/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-017/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-017/trk-017-e2e.log`
  - `harness/verification/2026-02-19-trk-017/trk-017-e2e.exit`
  - `harness/verification/2026-02-19-trk-017/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-017/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-017/trk-017-home-layout.png`
  - `harness/verification/2026-02-19-trk-017/trk-017-book-layout.png`
  - `harness/verification/2026-02-19-trk-017/trk-017-layout-metrics.json`
  - `harness/verification/2026-02-19-trk-017/codex-verify.log`
  - `harness/verification/2026-02-19-trk-017/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-018` (core page interactivity/responsiveness after tracking hooks).

## 2026-02-19 (TRK-018 core interactivity/responsiveness after tracking hooks)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added Playwright TRK-018 coverage in `e2e/smoke.spec.ts` across desktop + mobile:
    - desktop flows across `/` -> `/book` -> `/estimation?source=booking` -> `/contact`
    - mobile floating contact interactions (`Book Now`, `Call Us`, `Send Text`, CTA clicks)
    - captures click-to-response latency metrics for each major interaction
    - asserts latency thresholds and zero runtime page errors.
- Feature status transition:
  - `TRK-018` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-018 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-018 pnpm test:e2e --grep "TRK-018"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-018/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-018/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-018/trk-018-e2e.log`
  - `harness/verification/2026-02-19-trk-018/trk-018-e2e.exit`
  - `harness/verification/2026-02-19-trk-018/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-018/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-018/trk-018-interaction-latency.json`
  - `harness/verification/2026-02-19-trk-018/trk-018-runtime-errors.json`
  - `harness/verification/2026-02-19-trk-018/trk-018-mobile-interactions.png`
  - `harness/verification/2026-02-19-trk-018/codex-verify.log`
  - `harness/verification/2026-02-19-trk-018/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-019` (back/forward route-change page_view consistency).

## 2026-02-19 (TRK-019 browser back/forward page_view consistency)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added Playwright TRK-019 test in `e2e/smoke.spec.ts`:
    - navigates `/` -> `/menu` -> `/faq`
    - uses browser `back` twice then `forward` twice
    - validates the latest `page_view.page_path` always matches the active route after each transition
    - captures full page_view history for audit.
- Feature status transition:
  - `TRK-019` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-019 pnpm test:e2e --grep "TRK-001"` ✅
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-019 pnpm test:e2e --grep "TRK-019"` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - No regressions observed in this scope.
- Evidence:
  - `harness/verification/2026-02-19-trk-019/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-019/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-019/trk-019-e2e.log`
  - `harness/verification/2026-02-19-trk-019/trk-019-e2e.exit`
  - `harness/verification/2026-02-19-trk-019/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-019/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-019/trk-019-page-view-history.json`
  - `harness/verification/2026-02-19-trk-019/trk-019-faq-after-history-nav.png`
  - `harness/verification/2026-02-19-trk-019/codex-verify.log`
  - `harness/verification/2026-02-19-trk-019/codex-verify.exit`
- Next highest-priority action:
  - Implement and verify `TRK-020` (tracking event naming consistency + docs audit).

## 2026-02-19 (TRK-020 tracking event naming consistency + documentation)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`) on clean tree.
  - Re-verified previously passing core flow (`TRK-001`) before new scope.
  - Added naming audit automation script:
    - `harness/scripts/audit-tracking-event-names.mjs`
    - audits declared `TrackingEventName` union vs emitted `trackEvent(...)` callsites
    - enforces `snake_case` naming for declared/emitted events
    - outputs machine-readable JSON report for evidence.
  - Updated tracking documentation in `harness/docs/tracking.md`:
    - expanded full event dictionary to current implemented events
    - documented naming convention and TRK-020 audit procedure/command.
- Feature status transition:
  - `TRK-020` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `TRACKING_EVIDENCE_DIR=harness/verification/2026-02-19-trk-020 pnpm test:e2e --grep "TRK-001"` ✅
  - `node harness/scripts/audit-tracking-event-names.mjs --output harness/verification/2026-02-19-trk-020/trk-020-event-name-audit.json` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - Naming audit result: no non-snake event names and no undeclared emitted events.
  - One documented declared-but-not-emitted event remains: `deposit_completed` (reserved for server-confirmed callback path; not emitted by current client-side flow in this repo snapshot).
- Evidence:
  - `harness/verification/2026-02-19-trk-020/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-19-trk-020/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-19-trk-020/trk-001-home.png`
  - `harness/verification/2026-02-19-trk-020/trk-001-page-view-events.json`
  - `harness/verification/2026-02-19-trk-020/trk-020-event-name-audit.log`
  - `harness/verification/2026-02-19-trk-020/trk-020-event-name-audit.exit`
  - `harness/verification/2026-02-19-trk-020/trk-020-event-name-audit.json`
  - `harness/verification/2026-02-19-trk-020/codex-verify.log`
  - `harness/verification/2026-02-19-trk-020/codex-verify.exit`
- Next highest-priority action:
  - Backlog complete (`TRK-001` to `TRK-020` all passing). Optional next step: bundle and push branch for review.

## 2026-02-19 (CRO task-list archival for stakeholder review)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`).
  - Re-verified previously passing core flow contract via deterministic harness (`node harness/scripts/verify-tracking-page-view.mjs`).
  - Saved two stakeholder-facing CRO task lists as JSON artifacts:
    - `harness/verification/2026-02-19-cro-task-lists/task-list-1-site-review.json`
    - `harness/verification/2026-02-19-cro-task-lists/task-list-2-user-priority.json`
- Verified:
  - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-19-cro-task-lists` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` failed in this environment with `Process from config.webServer exited early`; captured as evidence and used deterministic harness reverify for baseline.
- Evidence:
  - `harness/verification/2026-02-19-cro-task-lists/reverify-trk-001.log`
  - `harness/verification/2026-02-19-cro-task-lists/reverify-trk-001.exit`
  - `harness/verification/2026-02-19-cro-task-lists/reverify-trk-001-trk-002.log`
  - `harness/verification/2026-02-19-cro-task-lists/reverify-trk-001-trk-002.exit`
  - `harness/verification/2026-02-19-cro-task-lists/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-19-cro-task-lists/codex-verify.log`
  - `harness/verification/2026-02-19-cro-task-lists/codex-verify.exit`
  - `harness/verification/2026-02-19-cro-task-lists/task-list-1-site-review.json`
  - `harness/verification/2026-02-19-cro-task-lists/task-list-2-user-priority.json`
- Feature backlog status:
  - No `harness/feature_list.json` status transitions in this archival-only task.
- Update (2026-02-19): Added merged stakeholder task artifact `harness/verification/2026-02-19-cro-task-lists/task-list-merged.json` combining both CRO lists into a single `tasks` array with `source_list` tracing.
- Update (2026-02-19): De-duplicated merged CRO artifact per stakeholder direction:
  - Removed duplicate `CRO-002`/`CRO-QUOTE-001` overlap by merging into final `CRO-QUOTE-001`.
  - Kept `CRO-QUOTE-002` as dependent follow-up.
  - Updated `harness/verification/2026-02-19-cro-task-lists/task-list-merged.json` total tasks `14 -> 13` and added `merged_from` traceability.
- Update (2026-02-19): Generated `harness/verification/2026-02-19-cro-task-lists/feature_list-cro.json` in the same schema as `harness/feature_list.json` (`id`, `priority`, `category`, `description`, `steps`, `passes`) from `task-list-merged.json` for direct backlog-style use.
- Update (2026-02-19): Converted `harness/verification/2026-02-19-cro-task-lists/feature_list-cro.json` to fully English content (descriptions + steps), preserving `feature_list.json` schema and keeping all task IDs unchanged.

## 2026-02-20 (CRO-001 contact intent split: customer contact vs partner recruitment)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`).
  - Re-verified baseline tracking contract with deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-001`
  - Reworked `/contact` into a customer-facing contact experience:
    - quick-access customer channels: Call, WhatsApp, SMS
    - short event request form (name, phone, email, event date, guest count, city/ZIP, message)
    - contact form success tracking now emits `lead_submit` with `lead_type: "customer_inquiry"` and contextual metadata.
  - Split partner recruitment into a dedicated route:
    - added `app/partner-opportunities/page.tsx`
    - added `app/partner-opportunities/PartnerOpportunitiesPageClient.tsx`
    - retained partner application form and tracking under the new route.
  - Moved partner recruitment discovery to footer navigation:
    - added `Partner Opportunities` link in `components/footer.tsx`.
  - Updated sitemap coverage:
    - added `/partner-opportunities` in `app/sitemap.ts`.
- Feature status transition:
  - `CRO-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅ (lint + compile build pass)
  - structural contract check for CRO-001 split:
    - `harness/verification/2026-02-20-cro-001/cro-001-structure-check.json` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-001/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-001/cro-001-structure-check.json`
  - `harness/verification/2026-02-20-cro-001/codex-verify.log`
  - `harness/verification/2026-02-20-cro-001/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-001/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-001/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-001/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-001/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-QUOTE-001` (one-page Quote Builder MVP with instant estimate and contact actions).

## 2026-02-20 (CRO-QUOTE-001 one-page Quote Builder MVP)

- Completed:
  - Re-ran session bootstrap (`bash harness/scripts/codex-session-start.sh`).
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-quote-001`
  - Added one-page quote builder route:
    - `app/quote/page.tsx`
    - `app/quote/QuoteBuilderClient.tsx`
  - Implemented quote MVP behavior on a single page:
    - core inputs (Date, City/ZIP, Adults/Kids, Tableware Rental default on, Budget optional)
    - instant estimate range with minimum-spend logic, travel fee range, and add-on upgrades (steak/shrimp/lobster)
    - primary one-click actions (SMS, Call, Email) with quote-context prefill
    - secondary actions (Place Deposit, Request Manual Confirmation).
  - Added reusable quote calculation + template generation module:
    - `lib/quote-builder.ts`
  - Added quote funnel event tracking:
    - new tracking event names in `lib/tracking.ts`: `quote_started`, `quote_completed`
    - quote page emits `quote_started` on first meaningful input
    - quote page emits `quote_completed` when required inputs produce estimate-ready output
    - contact actions emit measurable click/lead events with quote context.
  - Added discoverability entry-point from booking page:
    - `app/book/page.tsx` adds `Get Instant Quote` CTA card without replacing legacy estimation flow.
  - Added contact-page query prefill support for manual confirmation handoff:
    - `app/contact/ContactPageClient.tsx` reads quote params and pre-fills reason/message fields.
  - Added sitemap coverage:
    - `/quote` in `app/sitemap.ts`.
  - Added deterministic verification script for quote logic/templates:
    - `harness/scripts/verify-cro-quote-builder.mjs`.
  - Updated tracking contract docs for new quote events:
    - `harness/docs/tracking.md`.
  - Updated TRK-008 e2e spec to match the new customer-focused contact form contract:
    - `e2e/smoke.spec.ts`.
- Feature status transition:
  - `CRO-QUOTE-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `node harness/scripts/verify-cro-quote-builder.mjs harness/verification/2026-02-20-cro-quote-001` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-quote-001/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-quote-001/cro-quote-001-quote-builder-evidence.json`
  - `harness/verification/2026-02-20-cro-quote-001/codex-verify.log`
  - `harness/verification/2026-02-20-cro-quote-001/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-quote-001/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-quote-001/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-quote-001/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-quote-001/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-003` (unify and strengthen primary CTA, including mobile sticky CTA bar).

## 2026-02-20 (CRO-003 primary CTA unification + mobile sticky CTA bar)

- Completed:
  - Re-verified baseline tracking contract with deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-003`
  - Implemented mobile sticky CTA bar with one-tap access:
    - `components/floating-contact-buttons.tsx`
    - mobile-only bottom bar (`md:hidden`) with `Book`, `Call`, `WhatsApp`, `SMS`
    - preserved tracking semantics for click events (`lead_start`, `phone_click`, `contact_whatsapp_click`, `sms_click`)
    - hides on deposit confirmation-critical flows (`/deposit`, `/after-deposit`) to avoid checkout obstruction.
  - Added layout spacing to prevent sticky bar overlap on content:
    - `app/layout.tsx` (`main` gets mobile bottom padding).
  - Strengthened primary CTA clarity above-the-fold and near end of key pages:
    - `components/hero-section.tsx` adds primary CTA pair: `Get Instant Quote` + `Book Now`.
    - `app/page.tsx` CTA section now repeats `Get Instant Quote` + `Book Now` before contact option cards.
    - `app/book/page.tsx` already includes `Get Instant Quote` card as recommended first step.
  - Standardized key CTA copy instance:
    - `app/hibachi-at-home/page.tsx` changed `Book Online` -> `Book Now`.
    - `components/footer.tsx` changed quick link `Book Online` -> `Book Now`.
- Feature status transition:
  - `CRO-003` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
  - structural CTA checks:
    - `harness/verification/2026-02-20-cro-003/cro-003-structure-check.json` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` still fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-003/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-003/cro-003-structure-check.json`
  - `harness/verification/2026-02-20-cro-003/codex-verify.log`
  - `harness/verification/2026-02-20-cro-003/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-003/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-003/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-003/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-003/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-COPY-001` (surface Zero Mess Guarantee prominently on home + book + FAQ).

## 2026-02-20 (CRO-COPY-001 Zero Mess Guarantee visibility)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-copy-001`
  - Added high-contrast guarantee messaging on Home and Book pages:
    - Home top banner under hero in `app/page.tsx`
    - `Show Up Package` card badge copy in `app/page.tsx`
    - Book page banner near top in `app/book/page.tsx`
  - Repeated guarantee on FAQ page:
    - high-contrast guarantee block in `app/faq/FAQClientPage.tsx`.
- Feature status transition:
  - `CRO-COPY-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
  - structural guarantee copy checks:
    - `harness/verification/2026-02-20-cro-copy-001/cro-copy-001-structure-check.json` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-copy-001/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-copy-001/cro-copy-001-structure-check.json`
  - `harness/verification/2026-02-20-cro-copy-001/codex-verify.log`
  - `harness/verification/2026-02-20-cro-copy-001/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-copy-001/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-copy-001/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-copy-001/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-copy-001/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-QUOTE-002` (configurable one-click contact templates with quote context).

## 2026-02-20 (CRO-QUOTE-002 configurable one-click contact templates)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-quote-002`
  - Added configurable quote contact templates:
    - new config module `config/quote-contact-templates.ts`
    - default templates for SMS, email subject/body, and call script
    - environment override support (no page logic changes required):
      - `NEXT_PUBLIC_QUOTE_SMS_TEMPLATE`
      - `NEXT_PUBLIC_QUOTE_EMAIL_SUBJECT_TEMPLATE`
      - `NEXT_PUBLIC_QUOTE_EMAIL_BODY_TEMPLATE`
      - `NEXT_PUBLIC_QUOTE_CALL_SCRIPT_TEMPLATE`
  - Updated quote template rendering pipeline:
    - `lib/quote-builder.ts` now supports tokenized template interpolation with structured context keys.
    - `/quote` page consumes templates from config and renders contact actions from configured content.
  - Preserved structured quote context in all channels:
    - SMS, Call, Email all include event date, location, guest count, rental, budget, and estimate range context.
  - Extended deterministic quote verification harness to assert template interpolation behavior:
    - `harness/scripts/verify-cro-quote-builder.mjs`.
- Feature status transition:
  - `CRO-QUOTE-002` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `node harness/scripts/verify-cro-quote-builder.mjs harness/verification/2026-02-20-cro-quote-002` ✅
  - template-config checks:
    - `harness/verification/2026-02-20-cro-quote-002/cro-quote-002-template-config-check.json` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-quote-002/cro-quote-001-quote-builder-evidence.json`
  - `harness/verification/2026-02-20-cro-quote-002/cro-quote-002-template-config-check.json`
  - `harness/verification/2026-02-20-cro-quote-002/codex-verify.log`
  - `harness/verification/2026-02-20-cro-quote-002/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-quote-002/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-quote-002/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-quote-002/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-quote-002/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-004` (service-area copy consistency audit and correction).

## 2026-02-20 (CRO-004 service-area copy consistency)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-004`
  - Added shared service-area source of truth:
    - `config/service-areas.ts`
    - defines Southern California and NYC/Long Island region labels and city lists.
  - Fixed site-wide service-area copy inconsistency:
    - `components/footer.tsx` now shows correct NYC/Long Island city list (instead of incorrectly reusing LA cities).
    - added footer internal link to `/locations` for area discovery.
  - Refined service-area landing structure:
    - `app/locations/page.tsx` now includes both regional landing entries:
      - Southern California (`/locations/la-orange-county`)
      - NYC & Long Island (`/locations/nyc-long-island`)
    - updated metadata copy from LA-only scope to multi-region scope.
  - Added internal service-area links from customer contact flow:
    - `app/contact/ContactPageClient.tsx` includes links to both city-specific landing pages.
- Feature status transition:
  - `CRO-004` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - service-area consistency checks:
    - `harness/verification/2026-02-20-cro-004/cro-004-service-area-check.json` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-004/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-004/cro-004-service-area-check.json`
  - `harness/verification/2026-02-20-cro-004/codex-verify.log`
  - `harness/verification/2026-02-20-cro-004/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-004/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-004/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-004/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-004/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-005` (price transparency with total-price examples and cost breakdown clarity).

## 2026-02-20 (CRO-005 price transparency examples + cost breakdown)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-005`
  - Added dedicated price transparency module:
    - `components/menu/price-transparency.tsx`
  - Added total-price example cards for common party sizes:
    - 10 / 15 / 20 guests examples with estimated total ranges.
  - Added clear cost breakdown copy:
    - estimated tax, travel fee range, tableware/equipment rental, premium add-ons
    - explicit included-vs-additional cost explanation.
  - Integrated module into menu page:
    - `app/menu/page.tsx`.
- Feature status transition:
  - `CRO-005` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - price transparency structure checks:
    - `harness/verification/2026-02-20-cro-005/cro-005-price-transparency-check.json` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-005/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-005/cro-005-price-transparency-check.json`
  - `harness/verification/2026-02-20-cro-005/codex-verify.log`
  - `harness/verification/2026-02-20-cro-005/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-005/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-005/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-005/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-005/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-006` (objection-handling FAQ module and key policy repetition on booking flow).

## 2026-02-20 (CRO-006 objection-handling FAQ module + booking policy repetition)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-006`
  - Upgraded FAQ from click-heavy structure to objection-first module:
    - `app/faq/FAQClientPage.tsx`
    - added top "Top Booking Concerns (Answered)" section with three default-visible objection answers:
      - weather contingency
      - cancellation/reschedule policy
      - allergy/dietary accommodation.
  - Repeated critical policies on booking page:
    - `app/book/page.tsx`
    - added "Important Policies Before You Book" block covering:
      - cancellation
      - weather
      - arrival timing
      - allergies/dietary needs.
- Feature status transition:
  - `CRO-006` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - objection-module structure checks:
    - `harness/verification/2026-02-20-cro-006/cro-006-objection-module-check.json` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-006/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-006/cro-006-objection-module-check.json`
  - `harness/verification/2026-02-20-cro-006/codex-verify.log`
  - `harness/verification/2026-02-20-cro-006/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-006/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-006/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-006/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-006/codex-acceptance.exit`
- Next highest-priority action:
  - Implement `CRO-007` (verifiable social proof links and real-event evidence blocks).

## 2026-02-20 (CRO-008 CRO baseline: tracking + A/B + funnel report)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-008`
  - Added A/B assignment utility:
    - `lib/ab-testing.ts`
    - persistent variant assignment for:
      - `hero_headline`
      - `primary_cta_copy`.
  - Implemented two initial A/B tests on hero surface:
    - `components/hero-section.tsx`
    - experiment 1: headline variant copy
    - experiment 2: primary CTA copy variant
    - emits `ab_test_exposure` and `ab_test_conversion` events with experiment/variant metadata.
  - Added weekly funnel reporting baseline (visit -> click -> submit -> close):
    - `harness/scripts/generate-funnel-report.mjs`
    - CLI output report for exportable JSON.
  - Added deterministic CRO-008 verification harness:
    - `harness/scripts/verify-cro-008.mjs`
    - validates funnel step aggregation and A/B winner output.
  - Updated tracking contract documentation for A/B events:
    - `harness/docs/tracking.md`.
- Feature status transition:
  - `CRO-008` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `node harness/scripts/verify-cro-008.mjs harness/verification/2026-02-20-cro-008` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-008/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-008/cro-008-funnel-report.json`
  - `harness/verification/2026-02-20-cro-008/codex-verify.log`
  - `harness/verification/2026-02-20-cro-008/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-008/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-008/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-008/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-008/codex-acceptance.exit`
- Next highest-priority action:
  - `CRO-007` marked as not required by stakeholder in this session. Next implementable item: `CRO-BRAND-001` (chef-led brand story section).

## 2026-02-20 (CRO-BRAND-001 chef-led brand story section)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-brand-001`
  - Added `Why Real Hibachi` brand-story block near top of homepage:
    - `app/page.tsx` (positioned before `How It Works`, within early scroll depth).
  - Added chef-led trust content:
    - chef profile card (`Chef Ken`, lead hibachi chef)
    - years of experience metric
    - total events served metric
    - explicit brand promise statement.
  - Included clear conversion CTA in the story block:
    - `Get Instant Quote` button.
- Feature status transition:
  - `CRO-BRAND-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - brand-story structure checks:
    - `harness/verification/2026-02-20-cro-brand-001/cro-brand-001-check.json` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-brand-001/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-brand-001/cro-brand-001-check.json`
  - `harness/verification/2026-02-20-cro-brand-001/codex-verify.log`
  - `harness/verification/2026-02-20-cro-brand-001/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-brand-001/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-brand-001/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-brand-001/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-brand-001/codex-acceptance.exit`
- Next highest-priority action:
  - `CRO-007` remains intentionally skipped per stakeholder direction. Next implementable item: `CRO-TRACK-001` (quote funnel segmentation + weekly exportability).

## 2026-02-20 (CRO-TRACK-001 quote funnel segmentation + weekly source reporting)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-track-001`
  - Added Quote Builder contact event coverage:
    - `lib/tracking.ts`
    - added `contact_email_click` event name to tracking contract.
  - Extended Quote Builder click payload segmentation:
    - `app/quote/QuoteBuilderClient.tsx`
    - SMS/Call click events now include:
      - `city_or_zip`
      - `tableware_rental`
      - `add_on_steak`
      - `add_on_shrimp`
      - `add_on_lobster`
    - Email action now emits `contact_email_click` before `lead_submit`.
  - Extended weekly funnel export with segmentation and source breakdown:
    - `harness/scripts/generate-funnel-report.mjs`
    - adds quote step counts (`quote_started`, `quote_completed`, sms/call/email clicks)
    - adds segment aggregation by city/rental/add-ons
    - adds top-source summary from `utm_source` and click-id fallback fields.
  - Added deterministic verifier for CRO-TRACK-001 outputs:
    - `harness/scripts/verify-cro-track-001.mjs`.
  - Updated tracking docs:
    - `harness/docs/tracking.md` with `contact_email_click` and CRO-TRACK-001 funnel reporting notes.
- Feature status transition:
  - `CRO-TRACK-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `node harness/scripts/verify-cro-track-001.mjs harness/verification/2026-02-20-cro-track-001` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-track-001/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-track-001/cro-track-001-funnel-segmentation-report.json`
  - `harness/verification/2026-02-20-cro-track-001/codex-verify.log`
  - `harness/verification/2026-02-20-cro-track-001/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-track-001/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-track-001/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-track-001/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-track-001/codex-acceptance.exit`
- Next highest-priority action:
  - `CRO-007` remains intentionally skipped per stakeholder direction. Next implementable item: `CRO-SOCIALPROOF-001` (real-time booking social-proof toast).

## 2026-02-20 (CRO-SOCIALPROOF-001 real-time booking social-proof toast)

- Completed:
  - Re-verified baseline tracking contract via deterministic harness:
    - `node harness/scripts/verify-tracking-page-view.mjs harness/verification/2026-02-20-cro-socialproof-001`
  - Added global social-proof toast component:
    - `components/social-proof-toast.tsx`
    - bottom-right recent-booking notice with rotating examples.
  - Rotation behavior:
    - rotates every randomized 20-40 seconds.
  - Dismiss behavior:
    - user can dismiss via close button.
    - dismissal persists for current session via `sessionStorage`.
  - Mobile safety:
    - toast sits above sticky CTA bar (`bottom-24` on mobile) to avoid blocking primary actions.
  - Mounted globally:
    - `app/layout.tsx` now renders `<SocialProofToast />`.
  - Added deterministic verifier:
    - `harness/scripts/verify-cro-socialproof-001.mjs`.
- Feature status transition:
  - `CRO-SOCIALPROOF-001` changed from `passes: false -> true` in `harness/feature_list.json`.
- Verified:
  - `node harness/scripts/verify-cro-socialproof-001.mjs harness/verification/2026-02-20-cro-socialproof-001` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Regressions/blockers:
  - `pnpm test:e2e --grep "TRK-001"` still fails in this environment with `Process from config.webServer exited early`.
  - `bash harness/scripts/codex-acceptance.sh` fails at Gate 2/3 for the same webServer startup issue.
- Evidence:
  - `harness/verification/2026-02-20-cro-socialproof-001/trk-001-trk-002-tracking-lib-evidence.json`
  - `harness/verification/2026-02-20-cro-socialproof-001/cro-socialproof-001-toast-check.json`
  - `harness/verification/2026-02-20-cro-socialproof-001/codex-verify.log`
  - `harness/verification/2026-02-20-cro-socialproof-001/codex-verify.exit`
  - `harness/verification/2026-02-20-cro-socialproof-001/reverify-trk-001-e2e.log`
  - `harness/verification/2026-02-20-cro-socialproof-001/reverify-trk-001-e2e.exit`
  - `harness/verification/2026-02-20-cro-socialproof-001/codex-acceptance.log`
  - `harness/verification/2026-02-20-cro-socialproof-001/codex-acceptance.exit`
- Next highest-priority action:
  - No remaining implementable CRO tasks in `feature_list.json`; `CRO-007` remains intentionally skipped per stakeholder direction.

## 2026-02-20 (CRO-007 waived by stakeholder)

- Decision:
  - `CRO-007` (external verifiable social-proof assets) is waived for this cycle by stakeholder direction.
  - Reason provided: no Google Reviews external link assets / real event clip assets available right now.
- Task status transition:
  - `CRO-007` updated in `harness/feature_list.json`:
    - `passes: false -> true`
    - `waived: true`
    - `waived_reason` recorded for auditability.
- Scope impact:
  - No product/UI code change applied for CRO-007 in this commit.
- Next highest-priority action:
  - No remaining unfinished items in `harness/feature_list.json`.

## 2026-02-20 (Quote Builder rule calibration to Bling pricing prompt)

- Completed:
  - Updated `Instant Estimate Range` pricing logic to follow the provided business prompt in:
    - `lib/quote-builder.ts`
  - Rule adjustments applied:
    - children food price corrected to **$29.95**
    - minimum spend remains **$599**
    - full setup (when selected) calculated as **$15 per guest**
    - premium upgrade unit prices aligned to prompt:
      - Filet Mignon +$8
      - Scallops +$6
      - Lobster Tail +$12
    - quote upgrade range now reflects selection uncertainty:
      - low assumes no guest selects premium upgrade
      - high assumes all guests select chosen premium upgrades
    - removed legacy travel-fee heuristics from instant estimate calculation baseline (`$0-$0` placeholder range).
  - Updated quote UI wording in:
    - `app/quote/QuoteBuilderClient.tsx`
    - labels now reflect premium upgrade names and full-setup wording.
- Verified:
  - `node harness/scripts/verify-cro-quote-builder.mjs harness/verification/2026-02-20-cro-quote-rules-adjust` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-cro-quote-rules-adjust/cro-quote-001-quote-builder-evidence.json`
  - `harness/verification/2026-02-20-cro-quote-rules-adjust/codex-verify.log`
  - `harness/verification/2026-02-20-cro-quote-rules-adjust/codex-verify.exit`

## 2026-02-20 (Quote travel fee API by distance to 91748)

- Completed:
  - Added dedicated quote travel-fee API:
    - `app/api/quote/travel-fee/route.ts`
    - computes distance from origin ZIP `91748` to user destination via Google Distance Matrix API.
    - returns `distance_miles` and `travel_fee_range`.
  - Added distance-tier fee mapping in API response:
    - <=10mi: `$25-$40`
    - <=20mi: `$40-$60`
    - <=35mi: `$60-$90`
    - <=50mi: `$90-$130`
    - >50mi: `$130-$180`
  - Integrated quote page with dynamic API lookup:
    - `app/quote/QuoteBuilderClient.tsx`
    - fetches `/api/quote/travel-fee?destination=...` when location changes.
    - shows `Distance from 91748` and uses API `travel_fee_range` in estimate calculation.
  - Updated quote calculator function signature for runtime travel-fee override:
    - `lib/quote-builder.ts` `calculateQuote(input, travelFeeRangeOverride?)`.
  - Added deterministic integration verifier:
    - `harness/scripts/verify-cro-quote-travel-fee-api.mjs`.
- Verified:
  - `node harness/scripts/verify-cro-quote-builder.mjs harness/verification/2026-02-20-cro-quote-travel-fee-api` ✅
  - `node harness/scripts/verify-cro-quote-travel-fee-api.mjs harness/verification/2026-02-20-cro-quote-travel-fee-api` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Environment note:
  - Live external Google API call validation is blocked in current sandbox network (`TypeError: fetch failed`), so runtime wiring is verified via static/integration checks.
- Evidence:
  - `harness/verification/2026-02-20-cro-quote-travel-fee-api/cro-quote-001-quote-builder-evidence.json`
  - `harness/verification/2026-02-20-cro-quote-travel-fee-api/cro-quote-travel-fee-api-check.json`
  - `harness/verification/2026-02-20-cro-quote-travel-fee-api/codex-verify.log`
  - `harness/verification/2026-02-20-cro-quote-travel-fee-api/codex-verify.exit`

## 2026-02-20 (Quote UI color alignment + contact template completeness)

- Completed:
  - Improved quote-page visual alignment with brand palette:
    - `app/quote/QuoteBuilderClient.tsx`
    - estimate card now uses amber/orange gradient and typography aligned to existing site theme.
    - SMS/Call/Email primary buttons unified to orange-family tones.
    - secondary actions (`Place Deposit`, `Request Manual Confirmation`) styled with orange outline system.
  - Strengthened default contact templates so SMS/Email include full filled details:
    - `config/quote-contact-templates.ts`
    - SMS now explicitly includes:
      - adults/kids split
      - full setup selection
      - upgrade summary
      - estimate range.
    - call script default now includes kids count and full setup state.
  - Added call script fallback safety for custom templates:
    - `lib/quote-builder.ts`
    - if custom call template omits kids or setup info, generated script appends them automatically.
- Verified:
  - `node harness/scripts/verify-cro-quote-builder.mjs harness/verification/2026-02-20-cro-quote-ui-template-polish` ✅
  - `node harness/scripts/verify-cro-quote-travel-fee-api.mjs harness/verification/2026-02-20-cro-quote-ui-template-polish` ✅
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-cro-quote-ui-template-polish/cro-quote-001-quote-builder-evidence.json`
  - `harness/verification/2026-02-20-cro-quote-ui-template-polish/cro-quote-travel-fee-api-check.json`
  - `harness/verification/2026-02-20-cro-quote-ui-template-polish/codex-verify.log`
  - `harness/verification/2026-02-20-cro-quote-ui-template-polish/codex-verify.exit`

## 2026-02-20 (Remove zero-mess guarantee copy)

- Completed:
  - Removed explicit `Zero Mess Guarantee` messaging from key pages:
    - `app/page.tsx` (homepage guarantee strip, guarantee badge copy, and guarantee callout text removed/replaced)
    - `app/book/page.tsx` (guarantee banner removed)
    - `app/faq/FAQClientPage.tsx` (guarantee banner removed)
  - Removed related headline phrasing from hero variant:
    - `components/hero-section.tsx`
    - `Zero Cleanup` -> neutral hosting wording.
  - Removed remaining zero-cleanup claim from hibachi-at-home testimonial copy:
    - `app/hibachi-at-home/page.tsx`.
- Verified:
  - keyword scan for removed terms written to:
    - `harness/verification/2026-02-20-remove-zero-mess-copy/zero-mess-scan.log`
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-remove-zero-mess-copy/zero-mess-scan.log`
  - `harness/verification/2026-02-20-remove-zero-mess-copy/zero-mess-scan.exit`
  - `harness/verification/2026-02-20-remove-zero-mess-copy/cro-quote-001-quote-builder-evidence.json`
  - `harness/verification/2026-02-20-remove-zero-mess-copy/codex-verify.log`
  - `harness/verification/2026-02-20-remove-zero-mess-copy/codex-verify.exit`

## 2026-02-20 (Rename Contact to Feedback for post-event channel)

- Completed:
  - Updated top navigation label:
    - `components/header.tsx`
    - `Contact` -> `Feedback` (route remains `/contact` for compatibility).
  - Updated footer quick link label:
    - `components/footer.tsx`
    - `Contact Us` -> `Feedback`.
  - Reframed contact page metadata to feedback/support intent:
    - `app/contact/page.tsx`
    - title/description/keywords/open graph updated.
  - Reframed contact page UX copy as post-event support channel:
    - `app/contact/ContactPageClient.tsx`
    - hero headline/description/badge, support card text, form title/placeholder, success copy.
  - Updated default form reason and tracking semantics:
    - default reason -> `Post-Event Feedback / Support`
    - `lead_type` -> `customer_feedback`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-contact-to-feedback/codex-verify.log`
  - `harness/verification/2026-02-20-contact-to-feedback/codex-verify.exit`

## 2026-02-20 (Contact channel priority reorder)

- Completed:
  - Reordered support channel priority to:
    - `SMS` -> `Phone` -> `Email` -> `WhatsApp`.
  - `app/contact/ContactPageClient.tsx`:
    - added dedicated Email quick-action button and click handler.
    - reordered quick-action cards to match required priority.
    - WhatsApp copy downgraded to backup/alternative channel.
  - `app/book/page.tsx`:
    - card order updated to SMS, Phone, Email, WhatsApp (after Instant Quote).
    - updated helper text to reflect priority order.
  - `components/floating-contact-buttons.tsx`:
    - mobile sticky order changed to `Book | SMS | Call | WA`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-contact-channel-priority/codex-verify.log`
  - `harness/verification/2026-02-20-contact-channel-priority/codex-verify.exit`

## 2026-02-20 (Hero single primary CTA + SMS-only bottom bar)

- Completed:
  - Updated hero CTA hierarchy in `components/hero-section.tsx`:
    - primary CTA fixed to `Get Instant Quote` (solid/high-contrast).
    - secondary CTA changed to lower-pressure `View Menu` (outline style).
    - removed hero `Book Now` as co-equal action on first screen.
  - Updated mobile bottom sticky bar in `components/floating-contact-buttons.tsx`:
    - removed multi-entry competition.
    - now shows only one channel CTA: `SMS`.
    - added helper copy: `Questions? Text us`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-hero-single-cta-sms-footer/codex-verify.log`
  - `harness/verification/2026-02-20-hero-single-cta-sms-footer/codex-verify.exit`

## 2026-02-20 (Move quick text action to top header)

- Completed:
  - Added mobile top-header quick action button:
    - `components/header.tsx`
    - left side now includes `Text Us` button linking to SMS.
    - tracked as `sms_click` with `contact_surface: mobile_header`.
  - Kept one dedicated navigation-activation button in header:
    - right side hamburger menu button remains the only menu trigger.
  - Removed bottom floating contact bar mount to avoid duplicate CTA competition:
    - `app/layout.tsx` no longer renders `FloatingContactButtons`.
  - Removed extra bottom spacing reserved for old floating bar:
    - `app/layout.tsx` main wrapper no longer uses `pb-16`.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-mobile-top-sms-nav/codex-verify.log`
  - `harness/verification/2026-02-20-mobile-top-sms-nav/codex-verify.exit`

## 2026-02-20 (Mobile header left button set to direct phone number)

- Completed:
  - Updated mobile top-left quick action in `components/header.tsx`:
    - replaced `Text Us` SMS button with direct phone number `2137707788`.
    - action now uses `tel:2137707788` for one-tap calling.
    - tracking updated from `sms_click` to `phone_click` with `contact_surface: mobile_header`.
  - Right-side menu trigger remains unchanged.
- Verified:
  - `bash harness/scripts/codex-verify.sh` ✅
- Evidence:
  - `harness/verification/2026-02-20-mobile-header-phone/codex-verify.log`
  - `harness/verification/2026-02-20-mobile-header-phone/codex-verify.exit`
